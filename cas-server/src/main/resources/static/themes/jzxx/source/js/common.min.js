var addIcon="../deng/images/grid/using/add.png";var editIcon="../deng/images/grid/using/edit.png";var delIcon="../deng/images/grid/using/del.png";var copyPasteIcon="../deng/images/grid/classic/copyPaste_new.png";var detailIcon="../deng/images/grid/using/detail.png";var printIcon="../deng/images/grid/using/print.png";var dcIcon="../deng/images/grid/using/dc.png";var refreshIcon="../deng/images/grid/using/refresh.png";var searchIcon="../deng/images/grid/using/search.png";var clearSearchIcon="../deng/images/grid/using/clearSearch.png";var zkIcon="../deng/images/grid/using/zk_new.png";var cutIcon="../deng/images/grid/using/cut_new.png";var uploadIcon="../deng/images/grid/using/upload.png";var jhIcon="../deng/images/grid/using/jh_new.png";var backIcon="../deng/images/grid/using/back.png";var lingdangIcon="../deng/images/grid/using/lingdang.png";var clockIcon="../deng/images/grid/using/clock_new.png";var runIcon="../deng/images/grid/using/run.png";var saveIcon="../deng/images/grid/using/save.png";var listIcon="../deng/images/grid/using/list_.png";var indexlistIcon="../deng/images/grid/otp/listround.png";var payIcon="../deng/images/grid/using/pay.png";var phoneIcon="../deng/images/grid/using/phone.png";var collapsibleIcon="../deng/images/grid/using/collapsible.png";var taskIcon="../deng/images/grid/using/task.png";var homeIcon="../deng/images/home/home.png";var messageIcon="../deng/images/top/message.png";var lockIcon="../deng/images/grid/otp/lock.png";var indexlist="../deng/images/top/index_list.png";var indexNav="../deng/images/grid/otp/list.png";var indexUserIcon="../deng/images/top/index_user.png";var indexCollapseIcon="../deng/images/top/index_collapse.png";var indexSearchIcon="../deng/images/top/index_search.png";var indexRopot="../deng/images/top/indexRopot.png";var indexLingdang="../deng/images/top/lingdang16x16.png";var indexMail="../deng/images/top/indexMail.png";var indexIcon="../deng/images/home/index.png";var chattingIcon="../deng/images/icons/user.png";var designIcon="../deng/images/icons/cog.png";var iphoneIcon="../deng/images/icons/battery_full.png";var onoffIcon="../deng/images/icons/on-off.png";var bsdefimg="../deng/images/default/add_d.png";var uploadimg="../deng/images/common/uploadFFF.png";var uploadfaliimg="../deng/images/default/upload_fail.png";var uploadsucessimg="../deng/images/default/upload_sucess.png";var userIcon="../deng/images/default/user.png";function setCookie(name,value,minuts){var argv=setCookie.arguments;var argc=setCookie.arguments.length;var expiration=new Date((new Date()).getTime()+minuts*60000*60);window.parent.document.cookie=name+"="+escape(value)+"; expires="+expiration.toGMTString()}function getCookie(Name){var search=Name+"=";if(window.parent.document.cookie.length>0){offset=window.parent.document.cookie.indexOf(search);if(offset!=-1){offset+=search.length;end=window.parent.document.cookie.indexOf(";",offset);if(end==-1){end=window.parent.document.cookie.length}return unescape(window.parent.document.cookie.substring(offset,end))}else{return""}}}function clearCookie(name){var expdate=new Date();expdate.setTime(expdate.getTime()-(86400*1000*1));setCookie(name,"",expdate)}function delCookie(name){var exp=new Date();exp.setTime(exp.getTime()-1);var cval=getCookie(name);if(cval!=null){window.parent.document.cookie=name+"="+cval+";expires="+exp.toGMTString()}}Date.prototype.format=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format};function dateformat(data){if(null!=data){var date=new Date(data.time);return date.format("yyyy-MM-dd hh:mm:ss")}return""}function gValue(id){return Ext.getCmp(id).getValue()}function gTopValue(id){return Ext.getCmp(id).getValue()}function sValue(id,val){Ext.getCmp(id).setValue(val)}function sTopValue(id,val){Ext.getCmp(id).setValue(val)}function hiddenTopBtn(id){Ext.getCmp(id).setVisible(false)}function hiddenBtn(id){Ext.getCmp(id).setVisible(false)}function showTopBtn(id){Ext.getCmp(id).setVisible(true)}function showBtn(id){Ext.getCmp(id).setVisible(true)}function gfiValue(form,itemId){return form.getComponent(itemId).getValue()}function sfiValue(form,itemId,val){form.getComponent(itemId).setValue(val)}function sfValue(form){return form.getForm().findField(id_name).getValue()}function sfValue(form,id_name,val){form.form.findField(id_name).setValue(val)}function sfReadOnly(form,id_name,isReadOnly){return form.getForm().findField(id_name).setReadOnly(isReadOnly)}function randomColor(){return"#"+(function(h){return new Array(7-h.length).join("0")+h})((Math.random()*16777216<<0).toString(16))}function addTabContent(url,id,text,icon){var tabpanelCenter=Ext.getCmp("tabpanelCenter");var tabid="tab_"+id;if(tabpanelCenter.getComponent(tabid)){tabpanelCenter.remove(tabpanelCenter.getComponent(tabid))}var panel=Ext.create("Ext.Panel",{id:tabid,name:tabid,maskDiabled:true,title:text,closable:true,icon:icon,href:url,layoutOnTabChange:true,html:"<iframe width=100% height=100% id=xtIframe"+id+' name="xtIframe" src="'+basePath+"/"+url+'" frameborder="0" style="overflow:hidden;"/>'});tabpanelCenter.add(panel).show()}var page_number;var page_size;var pagesize_combo;var bbar;function getGridJsonStore(url,fields){return new Ext.data.JsonStore({autoLoad:{start:0,limit:30},pageSize:30,remoteSort:false,proxy:{type:"ajax",url:url,timeout:600000,actionMethods:{read:"POST"},reader:{type:"json",totalProperty:"total",root:"items",idProperty:"id"},success:function(response,options){},failure:function(response,options){}}})}function getGridJsonGroupStore(url,fields,groupfields){return new Ext.data.JsonStore({autoLoad:{start:0,limit:30},pageSize:30,remoteSort:false,groupField:groupfields,proxy:{type:"ajax",url:url,timeout:600000,actionMethods:{read:"POST"},reader:{type:"json",totalProperty:"total",root:"items",idProperty:"id"},success:function(response,options){},failure:function(response,options){}}})}function getGridBBar(store){pagesize_combo=Ext.create("Ext.form.ComboBox",{name:"pagesize",hiddenName:"pagesize",typeAhead:true,triggerAction:"all",lazyRender:true,mode:"local",store:new Ext.data.ArrayStore({fields:["value","text"],data:[[30,"30条/页"],[50,"50条/页"],[100,"100条/页"],[250,"250条/页"],[500,"500条/页"]]}),valueField:"value",displayField:"text",value:"30",editable:false,width:110});page_number=parseInt(pagesize_combo.getValue());pagesize_combo.on("select",function(comboBox){store.pageSize=parseInt(comboBox.getValue());page_number=parseInt(comboBox.getValue());store.load();store.on("beforeload",function(thiz,options){Ext.apply(thiz.proxy.extraParams,getParmas(store,null))})});bbar=Ext.create("Ext.PagingToolbar",{pageSize:page_number,store:store,firstText:"第一页",nextText:"下一页",prevText:"上一页",refreshText:"刷新",lastText:"最后一页",afterPageText:"页，共{0}页",beforePageText:"当前第",displayInfo:true,displayMsg:"当前显示从{0}至{1}，共 {2}条记录",emptyMsg:"没有记录",plugins:[new Ext.ux.ProgressBarPager()],items:["每页显示",pagesize_combo,"条记录"]});return bbar}function getGridTopBBar(store){pagesize_combo=Ext.create("Ext.form.ComboBox",{name:"pagesize",hiddenName:"pagesize",typeAhead:true,triggerAction:"all",lazyRender:true,mode:"local",store:new Ext.data.ArrayStore({fields:["value","text"],data:[[30,"30条/页"],[50,"50条/页"],[100,"100条/页"],[250,"250条/页"],[500,"500条/页"]]}),valueField:"value",displayField:"text",value:"30",editable:false,width:110});page_number=parseInt(pagesize_combo.getValue());pagesize_combo.on("select",function(comboBox){store.pageSize=parseInt(comboBox.getValue());page_number=parseInt(comboBox.getValue());store.load();store.on("beforeload",function(thiz,options){Ext.apply(thiz.proxy.extraParams,getParmas(store,null))})});bbar=Ext.create("Ext.PagingToolbar",{pageSize:page_number,store:store,firstText:"第一页",nextText:"下一页",prevText:"上一页",refreshText:"刷新",lastText:"最后一页",afterPageText:"页，共{0}页",beforePageText:"当前第",displayInfo:true,displayMsg:"当前显示从{0}至{1}，共 {2}条记录",emptyMsg:"没有记录",items:["每页显示",pagesize_combo,"条记录"]});return bbar}function beforeloadstore(parmas){store.on("beforeload",function(thiz,options){Ext.apply(thiz.proxy.extraParams,parmas)})}function beforeloadstoreByStore(objStore,parmas){objStore.on("beforeload",function(thiz,options){Ext.apply(thiz.proxy.extraParams,parmas)})}function load(grid,params){grid.getStore().reload({params:params})}function showToast(title,message){Ext.ux.Toast.msg(title,message)}function getJsonStore(url,fields){return new Ext.data.JsonStore({autoLoad:true,proxy:{type:"ajax",url:url,reader:{type:"json"}},fields:fields})}function getParmas(store,searchForm){var parmas;var start=(store.currentPage-1)*store.pageSize;if(null!=searchForm){parmas={start:start,limit:store.pageSize,searchJson:Ext.encode(searchForm.getForm().getFieldValues())}}else{parmas={start:start,limit:store.pageSize}}return parmas}function getCurr(store){return store.currentPage}function getPsize(store){return store.pageSize}function getCP(store){var array=new Array();array.push(store.currentPage);array.push(store.pageSize);return array}Ext.define("Ext.ux.comboboxtree",{extend:"Ext.form.field.Picker",requires:["Ext.tree.Panel"],initComponent:function(){var self=this;Ext.apply(self,{fieldLabel:self.fieldLabel,labelWidth:self.labelWidth});self.callParent()},createPicker:function(){var self=this;var store=Ext.create("Ext.data.TreeStore",{proxy:{type:"ajax",url:self.storeUrl},sorters:[{property:"leaf",direction:"ASC"},{property:"text",direction:"ASC"}],root:{id:self.rootId,text:self.rootText},nodeParameter:self.treeNodeParameter});self.picker=new Ext.tree.Panel({height:300,autoScroll:true,floating:true,focusOnToFront:false,shadow:true,ownerCt:this.ownerCt,useArrows:true,store:store,rootVisible:true});self.picker.on({checkchange:function(record,checked){var checkModel=self.checkModel;if(checkModel=="double"){var root=self.picker.getRootNode();root.cascadeBy(function(node){if(node.get("text")!=record.get("text")){node.set("checked",false)}});if(record.get("leaf")&&checked){self.setRawValue(record.get("id"));self.setValue(record.get("text"))}else{record.set("checked",false);self.setRawValue("");self.setValue("")}}else{var cascade=self.cascade;if(checked==true){if(cascade=="both"||cascade=="child"||cascade=="parent"){if(cascade=="child"||cascade=="both"){if(!record.get("leaf")&&checked){record.cascadeBy(function(record){record.set("checked",true)})}}if(cascade=="parent"||cascade=="both"){pNode=record.parentNode;for(;pNode!=null;pNode=pNode.parentNode){pNode.set("checked",true)}}}}else{if(checked==false){if(cascade=="both"||cascade=="child"||cascade=="parent"){if(cascade=="child"||cascade=="both"){if(!record.get("leaf")&&!checked){record.cascadeBy(function(record){record.set("checked",false)})}}}}}var records=self.picker.getView().getChecked(),names=[],values=[];Ext.Array.each(records,function(rec){names.push(rec.get("text"));values.push(rec.get("id"))});self.setRawValue(values.join(";"));self.setValue(names.join(";"))}},itemclick:function(tree,record,item,index,e,options){var checkModel=self.checkModel;if(checkModel=="single"){if(record.get("leaf")){self.setRawValue(record.get("id"));self.setValue(record.get("text"))}else{self.setRawValue("");self.setValue("")}}}});return self.picker},alignPicker:function(){var me=this,picker,isAbove,aboveSfx="-above";if(this.isExpanded){picker=me.getPicker();if(me.matchFieldWidth){picker.setWidth(me.bodyEl.getWidth())}if(picker.isFloating()){picker.alignTo(me.inputEl,"",me.pickerOffset);isAbove=picker.el.getY()<me.inputEl.getY();me.bodyEl[isAbove?"addCls":"removeCls"](me.openCls+aboveSfx);picker.el[isAbove?"addCls":"removeCls"](picker.baseCls+aboveSfx)}}}});function pWindow(url,pWidth,pHeight){var initUrl=url+"&time="+new Date();if(Ext.isEmpty(pWidth)){pWidth=800}if(Ext.isEmpty(pHeight)){pHeight=600}var left=(screen.width-pWidth)/2;var top=(screen.height-pHeight)/2;var str="dialogWidth="+pWidth+",dialogHeight="+pHeight+",top="+top+",left="+left+",toolbar=no,menubar=no,scrollbars=no,resizable=yes,location=no,status=no";window.showModalDialog(initUrl,window,str)}function showTopLoading(msg){var me=this,i=0,fn;Ext.MessageBox.show({title:"提示",msg:msg==null?"正在处理数据,请稍候...":msg,progressText:"正在处理数据,请稍候...",width:300,wait:true,waitConfig:{interval:150}});fn=function(){me.timer=null;++i;if(i===12){Ext.MessageBox.hide()}else{var val=i/11;Ext.MessageBox.updateProgress(val,Math.round(100*val)+"% 已完成进度");me.timer=Ext.defer(fn,500)}};me.timer=Ext.defer(fn,500)}function showLoading(msg){var me=this,i=0,fn;Ext.MessageBox.show({title:"提示",msg:msg==null?"正在处理数据,请稍候...":msg,progressText:msg==null?"正在处理数据,请稍候...":msg,width:300,progress:true,closable:false,waitConfig:{interval:150}});fn=function(){me.timer=null;++i;if(i===12){Ext.MessageBox.hide()}else{var val=i/11;Ext.MessageBox.updateProgress(val,Math.round(100*val)+"% 已完成进度");me.timer=Ext.defer(fn,500)}};me.timer=Ext.defer(fn,500)}function showWaitMsg(msg){var me=this,i=0,fn;Ext.MessageBox.show({title:"提示",msg:msg==null?"正在处理数据,请稍候...":msg,progressText:msg==null?"正在处理数据,请稍候...":msg,width:300,progress:true,closable:false,waitConfig:{interval:150}});fn=function(){me.timer=null;++i;if(i===12){Ext.MessageBox.hide()}else{var val=i/11;Ext.MessageBox.updateProgress(val,Math.round(100*val)+"% 已完成进度");me.timer=Ext.defer(fn,500)}};me.timer=Ext.defer(fn,500)}function hideWaitMsg(){Ext.MessageBox.hide()}function hideTopWaitMsg(){Ext.MessageBox.hide()}function showMsg(objPanel){if(objPanel==null||objPanel==""){new Ext.LoadMask(document.body,{msg:"正在加载数据中...",removeMask:true}).show()}else{new Ext.LoadMask(objPanel.el,{msg:"正在加载数据中..."}).show()}}function hideMsg(objPanel){if(objPanel==null||objPanel==""){new Ext.LoadMask(document.body,{msg:"正在加载数据中...",removeMask:true}).hide()}else{new Ext.LoadMask(objPanel.el,{msg:"正在加载数据...",removeMask:true}).hide()}}function loadFormData(forms,url){try{Ext.Ajax.timeout=180000;forms.getForm().load({url:url,waitTitle:"提示",method:"post",waitMsg:"正在载入数据，请稍后...",success:function(form,action){},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}}})}catch(e){console.info(e)}}function loadFormDataCallBack(forms,url,fn){try{Ext.Ajax.timeout=180000;forms.getForm().load({url:url,waitTitle:"提示",method:"post",waitMsg:"正在载入数据，请稍后...",success:function(form,action){fn(form,action)},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}}})}catch(e){console.info(e)}}function submitForm(subForm,url,grids,win,isHide,isReset){try{var items;if(null!=win){items=Ext.ComponentQuery.query("button",win)}if(subForm.form.isValid()){Ext.Msg.confirm("提示","确定要提交当前表单信息内容？",function(btn){if(btn=="yes"){for(var it in items){items[it].disable()}subForm.form.submit({url:url,timeout:600000,params:{ajaxform:0},waitTitle:"提示",actionMethods:{read:"POST"},method:"post",waitMsg:"正在保存数据，请稍后...",success:function(form,action){msgTishi(action.result.msg);if(isReset){subForm.form.reset()}if(null!=win&&""!=win){if(isHide){for(var it in items){items[it].enable()}win.hide()}else{win.close()}}if(null!=grids&&""!=grids){grids.getStore().reload()}},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}for(var it in items){items[it].enable()}}})}})}else{msgTishi("请输入必填项")}}catch(e){console.info(e)}}function submitFormCallFn(subForm,url,grids,win,isHide,isReset,fn){try{var items;if(null!=win){items=Ext.ComponentQuery.query("button",win)}if(subForm.form.isValid()){Ext.Msg.confirm("提示","确定要提交当前表单信息内容？",function(btn){if(btn=="yes"){for(var it in items){items[it].disable()}subForm.form.submit({url:url,timeout:600000,params:{ajaxform:0},waitTitle:"提示",actionMethods:{read:"POST"},method:"post",waitMsg:"正在保存数据，请稍后...",success:function(form,action){msgTishi(action.result.msg);if(isReset){subForm.form.reset()}if(null!=win&&""!=win){if(isHide){for(var it in items){items[it].enable()}win.hide()}else{win.close()}}if(null!=grids&&""!=grids){grids.getStore().reload()}fn(form,action)},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}for(var it in items){items[it].enable()}}})}})}else{msgTishi("请输入必填项")}}catch(e){console.info(e)}}function submitFormIncludeParams(subForm,url,grids,win,isHide,isReset,params){try{var items;if(null!=win){items=Ext.ComponentQuery.query("button",win)}if(subForm.form.isValid()){Ext.Msg.confirm("提示","确定要提交当前表单信息内容？",function(btn){if(btn=="yes"){for(var it in items){items[it].disable()}subForm.form.submit({url:url,timeout:600000,params:params,actionMethods:{read:"POST"},method:"post",waitTitle:"提示",waitMsg:"正在保存数据，请稍后...",success:function(form,action){msgTishi(action.result.msg);if(isReset){subForm.form.reset()}if(null!=win&&""!=win){if(isHide){for(var it in items){items[it].enable()}win.hide()}else{win.close()}}if(null!=grids&&""!=grids){grids.getStore().reload()}},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}for(var it in items){items[it].enable()}}})}})}else{msgTishi("请输入必填项")}}catch(e){console.info(e)}}function submitFormCallBack(subForm,url,grids,win,isHide,isReset,isCallForm,callUrl,callForm){try{var items;if(null!=win){items=Ext.ComponentQuery.query("button",win)}if(subForm.form.isValid()){Ext.Msg.confirm("提示","确定要提交当前表单信息内容？",function(btn){if(btn=="yes"){for(var it in items){items[it].disable()}subForm.form.submit({url:url,timeout:600000,params:{ajaxform:0},actionMethods:{read:"POST"},method:"post",waitTitle:"提示",waitMsg:"正在保存数据，请稍后...",success:function(form,action){msgTishi(action.result.msg);if(isReset){subForm.form.reset()}if(null!=win&&""!=win){if(isHide){for(var it in items){items[it].enable()}win.hide()}else{win.close()}}if(null!=grids&&""!=grids){grids.getStore().reload()}if(isCallForm){loadFormData(callForm,callUrl)}},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}for(var it in items){items[it].enable()}}})}})}else{msgTishi("请输入必填项")}}catch(e){console.info(e)}}function submitForm(subForm,url,grids,win,isHide,isReset,isExpandAll){try{var items;if(null!=win){items=Ext.ComponentQuery.query("button",win)}if(subForm.form.isValid()){Ext.Msg.confirm("提示","确定要提交当前表单信息内容？",function(btn){if(btn=="yes"){for(var it in items){items[it].disable()}subForm.form.submit({url:url,timeout:600000,params:{ajaxform:0},waitTitle:"提示",actionMethods:{read:"POST"},method:"post",waitMsg:"正在保存数据，请稍后...",success:function(form,action){msgTishi(action.result.msg);if(isReset){subForm.form.reset()}if(null!=win&&""!=win){if(isHide){for(var it in items){items[it].enable()}win.hide()}else{win.close()}}if(null!=grids&&""!=grids){grids.getStore().load()}if(isExpandAll){new Ext.util.DelayedTask(function(){grids.expandAll()}).delay(1000)}},failure:function(form,action){if(typeof(action.result.msg)!="undefined"){msgTishi(action.result.msg)}for(var it in items){items[it].enable()}}})}})}else{msgTishi("请输入必填项")}}catch(e){console.info(e)}}function ajaxRequest(url,grids,params,msg){try{showWaitMsg(msg);Ext.Ajax.request({params:params==null||""==params?{}:params,url:url,timeout:600000,method:"post",success:function(response,opts){hideWaitMsg();var obj=Ext.decode(response.responseText);if(null!=grids&&""!=grids){grids.getStore().reload()}if(typeof(obj.xt_pt_status)!="undefined"){if((obj.xt_pt_status==777||obj.xt_pt_status==1||obj.xt_pt_status!=888)){return}}if(typeof(obj.msg)!="undefined"){msgTishi(obj.msg)}},failure:function(response,opts){hideWaitMsg()}})}catch(e){console.info(e)}}function ajaxRequestCallFn(url,grids,params,msg,fn){try{showWaitMsg(msg);Ext.Ajax.request({params:params==null||""==params?{}:params,url:url,timeout:600000,method:"post",success:function(response,opts){hideWaitMsg();var obj=Ext.decode(response.responseText);if(null!=grids&&""!=grids){grids.getStore().reload()}if(typeof(obj.xt_pt_status)!="undefined"){if((obj.xt_pt_status==777||obj.xt_pt_status==1||obj.xt_pt_status!=888)){return}}if(typeof(obj.msg)!="undefined"){msgTishi(obj.msg)}fn(response,opts)},failure:function(response,opts){hideWaitMsg();fn(response,opts)}})}catch(e){console.info(e)}}function ajaxReq(url,gridArray,params,msg){try{showWaitMsg(msg);Ext.Ajax.request({params:params==null||""==params?{}:params,url:url,method:"post",timeout:600000,success:function(response,opts){hideWaitMsg();var obj=Ext.decode(response.responseText);for(var i=0;i<gridArray.length;i++){if(null!=gridArray[i]&&""!=gridArray[i]){gridArray[i].getStore().reload()}}if(typeof(obj.xt_pt_status)!="undefined"){if((obj.xt_pt_status==777||obj.xt_pt_status==1||obj.xt_pt_status!=888)){return}}msgTishi(obj.msg)},failure:function(response,opts){hideWaitMsg()}})}catch(e){console.info(e)}}Ext.define("Ext.ux.ComboGrid",{extend:"Ext.form.ComboBox",alias:["widget.combogrid"],createPicker:function(){var me=this,picker,menuCls=Ext.baseCSSPrefix+"menu",opts=Ext.apply({selModel:{mode:me.multiSelect?"SIMPLE":"SINGLE"},floating:true,hidden:true,ownerCt:me.ownerCt,cls:me.el.up("."+menuCls)?menuCls:"",store:me.store,displayField:me.displayField,focusOnToFront:false,pageSize:me.pageSize,bbar:Ext.create("Ext.PagingToolbar",{store:me.store,displayInfo:true,displayMsg:"本页显示 {0} - {1}，共计{2}条",emptyMsg:"没有符合条件的数据"})},me.listConfig,me.defaultListConfig);picker=me.picker=Ext.create("Ext.grid.Panel",opts);picker.getNode=function(){picker.getView().getNode(arguments)};console.log(me);return picker}});function msgTishi(msg){top.window.parent.toastrBoot(3,msg)}function confirmTishi(msg){var flag=false;Ext.Msg.confirm("提示",msg,function(btn){if(btn=="yes"){flag=true}else{flag=false}});return flag}function phoneLogin(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)){return"phone"}else{return"pc"}}var clientWidth=0;var clientHeight=0;function reGetWidthAndHeight(){var cvh=Ext.getBody().getViewSize();clientWidth=cvh.width;clientHeight=cvh.height}function reGetTopWidthAndHeight(){var cvh=Ext.getBody().getViewSize();clientWidth=cvh.width;clientHeight=cvh.height}function clearCookie(name){var expdate=new Date();expdate.setTime(expdate.getTime()-(86400*1000*1));setCookie(name,"",expdate)}var ieVison=6;function getnavigator(){if(navigator.userAgent.indexOf("MSIE")>0){if(navigator.userAgent.indexOf("MSIE 6.0")>0){ieVison=6}else{if(navigator.userAgent.indexOf("MSIE 7.0")>0){ieVison=7}else{if(navigator.userAgent.indexOf("MSIE 8.0")>0){ieVison=8}else{if(navigator.userAgent.indexOf("MSIE 9.0")>0){ieVison=9}else{if(navigator.userAgent.indexOf("MSIE 10.0")>0){ieVison=10}else{if(navigator.userAgent.indexOf("MSIE 11.0")>0){ieVison=11}else{ieVison=0}}}}}}}else{if(navigator.userAgent.indexOf("Firefox")>0){ieVison=1}else{ieVison=-1}}return ieVison}function selectAll(grid){grid.getSelectionModel().selectAll()}function unSelectAll(grid){grid.getSelectionModel().clearSelections();grid.getView().refresh()}function refreshGrid(grid){grid.getStore().reload()}function printerGrid(grid){Ext.ux.grid.Printer.printAutomatically=false;Ext.ux.grid.Printer.print(grid)}function exportExcel(grid,url){var data=[];var store=grid.getStore();var columns=grid.columns;store.each(function(record){data.push(record.data)},this);var headerIndex=[];for(var i=0;i<columns.length;i++){if(columns[i].xtype=="gridcolumn"&&!columns[i].hidden&&!columns[i].hiddenAncestor){headerIndex.push(columns[i].dataIndex)}}var headText=[];for(var i=0;i<columns.length;i++){if(columns[i].xtype=="gridcolumn"&&!columns[i].hidden&&!columns[i].hiddenAncestor){headText.push(columns[i].text)}}if(!Ext.fly("frmDummy")){var frm=document.createElement("form");frm.id="frmDummy";frm.name=grid.getId();frm.className="x-hidden";document.body.appendChild(frm)}showWaitMsg("正在导出数据...");Ext.Ajax.request({disableCaching:true,url:url,method:"POST",isUpload:true,timeout:600000,form:Ext.fly("frmDummy"),params:{bdownflag:"bdownflag",excleData:encodeURIComponent(Ext.encode(data)),excleHeader:encodeURIComponent(Ext.encode(headerIndex)),excleText:encodeURIComponent(Ext.encode(headText))}});hideWaitMsg()}function exportExcelByCondition(url,searchForm){if(!Ext.fly("frmDummy")){var frm=document.createElement("form");frm.id="frmDummy";frm.name=grid.getId();frm.className="x-hidden";document.body.appendChild(frm)}showWaitMsg("正在导出数据...");Ext.Ajax.request({disableCaching:true,url:url,method:"POST",isUpload:true,timeout:600000,form:Ext.fly("frmDummy"),params:{bdownflag:"bdownflag",searchJson:Ext.encode(searchForm.getForm().getFieldValues())}});hideWaitMsg()}function resetTitle(panel,isSetBackGround){var rpanel=[];for(var i in panel.items.items){if(panel.items.items[i].xtype=="form"){rpanel.push(panel.items.items[i])}}for(var i in rpanel){var num=parseInt(i)+1;rpanel[i].setTitle("编号."+num);if(isSetBackGround){if(i%2==0){rpanel[i].setBodyStyle("background-color:#f5f5f5")}}}}var searchForm;function initSearchForm(panelPosition,items,isTop,labelPosition){var panelTop="";if(isTop){panelTop=""}searchForm=Ext.create(panelTop+"Ext.FormPanel",{collapsible:false,collapsed:false,region:panelPosition,defaultType:"textfield",title:"查询区域",fieldDefaults:{labelWidth:70,style:"margin-left:10px;padding:5px 5px 5px 5px",labelAlign:labelPosition,margin:"4 5 4 5"},items:[items]})}function initSearchFormByUserdefined(panelPosition,items,isTop,labelPosition){var panelTop="";if(isTop){panelTop=""}return Ext.create(panelTop+"Ext.FormPanel",{collapsible:false,collapsed:false,region:panelPosition,defaultType:"textfield",title:"查询区域",fieldDefaults:{labelWidth:70,style:"margin-left:10px;padding:5px 5px 5px 5px",labelAlign:labelPosition,margin:"4 5 4 5"},items:[items]})}function initSearch(store,url,searchForm){store.load({url:url,method:"post",params:{start:0,limit:getGridBBar(store).pageSize,searchJson:Ext.encode(searchForm.getForm().getFieldValues())}})}function cSData(){var comboData=Ext.create("Ext.data.SimpleStore",{fields:["value","text"],data:[["1","等于"],["2","大于等于"],["3","小于等于"],["4","大于"],["5","小于"]]});return comboData}function overLoad(){if(document.readyState=="complete"){setTimeout(function(){Ext.get("loading").remove();Ext.get("loading-mask").fadeOut({opacity:0.3,easing:"easeOut",duration:500,remove:true,useDisplay:false})},300)}}function loading(){}function initDataGrid(grid){grid.getStore().on("load",function(s,records){setTimeout(function(){for(var i=0;i<store.getCount();i++){store.getAt(i).commit()}},500)})}function initData(dataStore,value){var xt_data_dictionary_name="∨";for(var i=0;i<dataStore.getCount();i++){var xt_data_dictionary_id=dataStore.getAt(i).get("xt_data_dictionary_id");if(xt_data_dictionary_id==value){xt_data_dictionary_name=dataStore.getAt(i).get("xt_data_dictionary_name");break}}return xt_data_dictionary_name}function initComBoData(dataStore,value,combo_value_field,combo_text_field){var field_name_value="∨";for(var i=0;i<dataStore.getCount();i++){var field_name_=dataStore.getAt(i).get(combo_value_field);if(field_name_==value){field_name=dataStore.getAt(i).get(combo_text_field);break}}return field_name}var optuploadWin;var optuploadForm;function optupload(fieldid,picid,flag,validateparameter,validateSize,xt_path_absolutek,xt_path_relativek,xt_path_urlk){if(flag==2){optuploadForm=Ext.create("Ext.FormPanel",{waitMsgTarget:true,defaultType:"textfield",autoScroll:true,fieldDefaults:{labelWidth:70,labelAlign:"left",margin:"5 5 5 5",flex:1},scrollable:true,scrollable:"x",scrollable:"y",items:[{fieldLabel:"校验参数（pdf,png,jpg,bmp等等以逗号分隔）",xtype:"textfield",hidden:true,id:"validateparameter",name:"validateparameter",maxLength:32,anchor:"100%"},{fieldLabel:'大小（格式如"1024-10240" 表示最小1024KB最大10240KB）',xtype:"textfield",hidden:true,id:"validateSize",name:"validateSize",maxLength:32,anchor:"100%"},{fieldLabel:"平台路径配置中心键（自定义上传绝路径使用）",xtype:"textfield",hidden:true,id:"xt_path_absolutek",name:"xt_path_absolutek",maxLength:32,anchor:"100%"},{fieldLabel:"平台路径配置中心键（自定义上传相对路径使用）",xtype:"textfield",hidden:true,id:"xt_path_relativek",name:"xt_path_relativek",maxLength:32,anchor:"100%"},{fieldLabel:"平台路径配置中心键（自定义上传路径 自定义URL地址）",xtype:"textfield",hidden:true,id:"xt_path_urlk",name:"xt_path_urlk",maxLength:32,anchor:"100%"},{xtype:"filefield",emptyText:"请选择要上传的文件",name:"picFile",buttonText:"选择文件...",anchor:"100%",allowBlank:false,buttonConfig:{icon:uploadimg}}]});if(null!=validateparameter&&""!=validateparameter&&typeof(validateparameter)!="undefined"){sTopValue("validateparameter",validateparameter)}if(null!=validateSize&&""!=validateSize&&typeof(validateSize)!="undefined"){sTopValue("validateSize",validateSize)}if(null!=xt_path_relativek&&""!=xt_path_relativek&&typeof(xt_path_relativek)!="undefined"){sTopValue("xt_path_relativek",xt_path_relativek)}if(null!=xt_path_absolutek&&""!=xt_path_absolutek&&typeof(xt_path_absolutek)!="undefined"){sTopValue("xt_path_absolutek",xt_path_absolutek)}if(null!=xt_path_urlk&&""!=xt_path_urlk&&typeof(xt_path_urlk)!="undefined"){sTopValue("xt_path_urlk",xt_path_urlk)}}else{optuploadForm=Ext.create("Ext.FormPanel",{waitMsgTarget:true,defaultType:"textfield",autoScroll:true,fieldDefaults:{labelWidth:70,labelAlign:"left",margin:"5 5 5 5",flex:1},scrollable:true,scrollable:"x",scrollable:"y",items:[{fieldLabel:"校验参数（pdf,png,jpg,bmp等等以逗号分隔）",xtype:"textfield",hidden:true,id:"validateparameter",name:"validateparameter",maxLength:32,anchor:"100%"},{fieldLabel:'大小（格式如"1024-10240" 表示最小1024KB最大10240KB）',xtype:"textfield",hidden:true,id:"validateSize",name:"validateSize",maxLength:32,anchor:"100%"},{fieldLabel:"平台路径配置中心键（自定义上传对绝路径使用）",xtype:"textfield",hidden:true,id:"xt_path_absolutek",name:"xt_path_absolutek",maxLength:32,anchor:"100%"},{fieldLabel:"平台路径配置中心键（自定义上传相对路径使用）",xtype:"textfield",hidden:true,id:"xt_path_relativek",name:"xt_path_relativek",maxLength:32,anchor:"100%"},{fieldLabel:"平台路径配置中心键（自定义上传路径 自定义URL地址）",xtype:"textfield",hidden:true,id:"xt_path_urlk",name:"xt_path_urlk",maxLength:32,anchor:"100%"},{xtype:"filefield",emptyText:"请选择要上传的文件",name:"picFile",buttonText:"选择文件...",anchor:"100%",allowBlank:false,buttonConfig:{icon:uploadimg}}]});if(null!=validateparameter&&""!=validateparameter&&typeof(validateparameter)!="undefined"){sValue("validateparameter",validateparameter)}if(null!=validateSize&&""!=validateSize&&typeof(validateSize)!="undefined"){sValue("validateSize",validateSize)}if(null!=xt_path_absolutek&&""!=xt_path_absolutek&&typeof(xt_path_absolutek)!="undefined"){sValue("xt_path_absolutek",xt_path_absolutek)}if(null!=xt_path_relativek&&""!=xt_path_relativek&&typeof(xt_path_relativek)!="undefined"){sValue("xt_path_relativek",xt_path_relativek)}if(null!=xt_path_urlk&&""!=xt_path_urlk&&typeof(xt_path_urlk)!="undefined"){sValue("xt_path_urlk",xt_path_urlk)}}if(flag==2){optuploadWin=Ext.create("Ext.Window",{layout:"fit",width:400,autoHeight:true,closable:false,animateTarget:document.body,plain:true,modal:true,buttonAlign:"right",title:"附件上传",fieldDefaults:{labelWidth:70,labelAlign:"left",flex:1,margin:"5 5 5 5"},listeners:{minimize:function(win,opts){win.collapse()}},items:optuploadForm,buttons:[{text:"开始上传",itemId:"save",handler:function(button){if(optuploadForm.form.isValid()){var items=Ext.ComponentQuery.query("button",optuploadWin);for(var it in items){items[it].disable()}optuploadForm.submit({url:basePath+"/xtCommonController/upload",timeout:600000,waitMsg:"正在上传中，请稍后...",success:function(form,action){msgTishi(action.result.data.msg);if(action.result.data.jsonID!=0){Ext.getCmp(picid).getEl().dom.src=action.result.data.jsonValue;Ext.getCmp(fieldid).setValue(action.result.data.jsonID);optuploadWin.close()}else{for(var it in items){items[it].enable()}}},failure:function(response,opts){for(var it in items){items[it].enable()}}})}else{msgTishi("请选择图片")}}},{text:"关闭",itemId:"close",handler:function(button){optuploadWin.close()}}]})}else{optuploadWin=Ext.create("Ext.Window",{layout:"fit",width:400,autoHeight:true,closable:false,title:"附件上传",animateTarget:document.body,plain:true,modal:true,buttonAlign:"right",fieldDefaults:{labelWidth:70,labelAlign:"left",flex:1,margin:"5 5 5 5"},listeners:{minimize:function(win,opts){win.collapse()}},items:optuploadForm,buttons:[{text:"开始上传",itemId:"save",handler:function(button){if(optuploadForm.form.isValid()){var items=Ext.ComponentQuery.query("button",optuploadWin);for(var it in items){items[it].disable()}optuploadForm.submit({url:basePath+"/xtCommonController/upload",waitMsg:"正在上传中，请稍后...",success:function(form,action){msgTishi(action.result.data.msg);if(action.result.data.jsonID!=0){Ext.getCmp(picid).getEl().dom.src=action.result.data.jsonValue;Ext.getCmp(fieldid).setValue(action.result.data.jsonID);optuploadWin.close()}else{for(var it in items){items[it].enable()}}},failure:function(response,opts){for(var it in items){items[it].enable()}}})}else{msgTishi("请选择图片")}}},{text:"关闭",itemId:"close",handler:function(button){optuploadWin.close()}}]})}optuploadWin.show()}function ajaxFilePathBackRequest(url,params,flag){Ext.Ajax.request({params:params==null||""==params?{}:params,url:url,method:"post",timeout:600000,success:function(response,opts){var obj=Ext.decode(response.responseText);for(var i=0;i<obj.items.length;i++){if(flag==2){if(typeof(Ext.getCmp(obj.items[i].field_name+"_pic"))!="undefined"){Ext.getCmp(obj.items[i].field_name+"_pic").getEl().dom.src=obj.items[i].xt_attachmentPath}}else{if(typeof(Ext.getCmp(obj.items[i].field_name+"_pic"))!="undefined"){Ext.getCmp(obj.items[i].field_name+"_pic").getEl().dom.src=obj.items[i].xt_attachmentPath}}}},failure:function(response,opts){var obj=Ext.decode(response.responseText)}})}function initFileRight(fieldid,picid,flag,isUpAndDelete,validateparameter,validateSize,xt_path_absolutek,xt_path_relativek,xt_path_urlk){if(isUpAndDelete==2){if(flag==1){var contextmenuFile=new Ext.menu.Menu({items:[{text:"下 载",glyph:61465,handler:function(){var xt_attachment_id=Ext.getCmp(fieldid).getValue();downOrExport(basePath+"/xtCommonController/downFile?xt_attachment_id="+xt_attachment_id)}},"-",{text:"复制文件地址",glyph:61637,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;Ext.Msg.alert("复制文件地址",url_path)}},"-",{text:"查 看",glyph:61893,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;getimghw(url_path)}}]});Ext.getCmp(picid).getEl().on("contextmenu",function(e){e.preventDefault();contextmenuFile.showAt(e.getXY())})}else{var contextmenuFile=new Ext.menu.Menu({items:[{text:"下 载",glyph:61465,handler:function(){var xt_attachment_id=Ext.getCmp(fieldid).getValue();downOrExport(basePath+"/xtCommonController/downFile?xt_attachment_id="+xt_attachment_id)}},"-",{text:"复制文件地址",glyph:61637,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;Ext.Msg.alert("复制文件地址",url_path)}},"-",{text:"查 看",glyph:61893,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;getimghw(url_path)}}]});Ext.getCmp(picid).getEl().on("contextmenu",function(e){e.preventDefault();contextmenuFile.showAt(e.getXY())})}}else{if(flag==2){var contextmenuFile=new Ext.menu.Menu({items:[{text:"上 传",glyph:61587,handler:function(){optupload(fieldid,picid,2,validateparameter,validateSize,xt_path_absolutek,xt_path_relativek,xt_path_urlk)}},{text:"下 载",glyph:61465,handler:function(){var xt_attachment_id=Ext.getCmp(fieldid).getValue();downOrExport(basePath+"/xtCommonController/downFile?xt_attachment_id="+xt_attachment_id)}},"-",{text:"删 除",glyph:61460,handler:function(){Ext.getCmp(picid).getEl().dom.src=bsdefimg;Ext.getCmp(fieldid).setValue("")}},"-",{text:"复制文件地址",glyph:61637,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;Ext.Msg.alert("复制文件地址",url_path)}},"-",{text:"查 看",glyph:61893,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;getimghw(url_path)}}]});Ext.getCmp(picid).getEl().on("contextmenu",function(e){e.preventDefault();contextmenuFile.showAt(e.getXY())})}else{var contextmenuFile=new Ext.menu.Menu({items:[{text:"上 传",glyph:61587,handler:function(){optupload(fieldid,picid,1,validateparameter,validateSize,xt_path_absolutek,xt_path_relativek,xt_path_urlk)}},{text:"下 载",glyph:61465,handler:function(){var xt_attachment_id=Ext.getCmp(fieldid).getValue();downOrExport(basePath+"/xtCommonController/downFile?xt_attachment_id="+xt_attachment_id)}},"-",{text:"删 除",glyph:61460,handler:function(){Ext.getCmp(picid).getEl().dom.src=bsdefimg;Ext.getCmp(fieldid).setValue("")}},"-",{text:"复制文件地址",glyph:61637,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;Ext.Msg.alert("复制文件地址",url_path)}},"-",{text:"查 看",glyph:61893,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;getimghw(url_path)}}]});Ext.getCmp(picid).getEl().on("contextmenu",function(e){e.preventDefault();contextmenuFile.showAt(e.getXY())})}}}function initTopFileRight(fieldid,picid,flag,isUpAndDelete,validateparameter,validateSize,xt_path_absolutek,xt_path_relativek,xt_path_urlk){if(isUpAndDelete==2){var contextmenuFile=new Ext.menu.Menu({items:[{text:"下 载",glyph:61465,handler:function(){var xt_attachment_id=Ext.getCmp(fieldid).getValue();downOrExport(basePath+"/xtCommonController/downFile?xt_attachment_id="+xt_attachment_id)}},"-",{text:"复制文件地址",glyph:61637,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;Ext.Msg.alert("复制文件地址",url_path)}},"-",{text:"查 看",glyph:61893,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;getimghw(url_path)}}]});Ext.getCmp(picid).getEl().on("contextmenu",function(e){e.preventDefault();contextmenuFile.showAt(e.getXY())})}else{var contextmenuFile=new Ext.menu.Menu({items:[{text:"上 传",glyph:61587,handler:function(){optupload(fieldid,picid,2,validateparameter,validateSize,xt_path_absolutek,xt_path_relativek,xt_path_urlk)}},{text:"下 载",glyph:61465,handler:function(){var xt_attachment_id=Ext.getCmp(fieldid).getValue();downOrExport(basePath+"/xtCommonController/downFile?xt_attachment_id="+xt_attachment_id)}},"-",{text:"删 除",glyph:61460,handler:function(){Ext.getCmp(picid).getEl().dom.src=bsdefimg;Ext.getCmp(fieldid).setValue("")}},"-",{text:"复制文件地址",glyph:61637,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;Ext.Msg.alert("复制文件地址",url_path)}},"-",{text:"查 看",glyph:61893,handler:function(){var url_path=Ext.getCmp(picid).getEl().dom.src;getimghw(url_path)}}]});Ext.getCmp(picid).getEl().on("contextmenu",function(e){e.preventDefault();contextmenuFile.showAt(e.getXY())})}}function downOrExport(url){if(!Ext.fly("frmDownOrExport")){var frm=document.createElement("form");frm.id="frmDownOrExport";frm.name=grid.getId();frm.className="x-hidden";document.body.appendChild(frm)}showWaitMsg("正在下载中...");Ext.Ajax.request({disableCaching:true,url:url,method:"POST",isUpload:true,timeout:600000,form:Ext.fly("frmDownOrExport"),params:{bdownflag:"bdownflag"}});hideWaitMsg()}function initrightgridcontextmenu(gd,contextmenu,items){var contextmenu_array=contextmenu.items.items;gd.on("itemcontextmenu",function(view,record,item,index,e){e.preventDefault();for(var i=0;i<contextmenu_array.length;i++){for(var j=0;j<items.length;j++){if(contextmenu_array[i].id==items[j]){contextmenu_array[i].setDisabled(false)}}}contextmenu.showAt(e.getXY())});gd.on("headercontextmenu",function(view,colIndex,e){gd.getSelectionModel().clearSelections();gd.getView().refresh();e.preventDefault();for(var i=0;i<contextmenu_array.length;i++){for(var j=0;j<items.length;j++){if(contextmenu_array[i].id==items[j]){contextmenu_array[i].setDisabled(true)}}}contextmenu.showAt(e.getXY())});gd.on("containercontextmenu",function(view,e,opt){gd.getSelectionModel().clearSelections();gd.getView().refresh();e.preventDefault();for(var i=0;i<contextmenu_array.length;i++){for(var j=0;j<items.length;j++){if(contextmenu_array[i].id==items[j]){contextmenu_array[i].setDisabled(true)}}}contextmenu.showAt(e.getXY())})}function clearFilter(grid){var view=grid.getView();grid.getRootNode().cascadeBy(function(tree,view){var uiNode=view.getNodeByRecord(this);if(uiNode){Ext.get(uiNode).setDisplayed("table-row")}},null,[this,view])}function filterBy(grid,text,by){clearFilter(grid);var view=grid.getView(),nodesAndParents=[];grid.getRootNode().cascadeBy(function(tree,view){var currNode=this;if(currNode&&currNode.data[by]&&currNode.data[by].toString().toLowerCase().indexOf(text.toLowerCase())>-1){grid.expandPath(currNode.getPath());while(currNode.parentNode){nodesAndParents.push(currNode.id);currNode=currNode.parentNode}}},null,[grid,view]);grid.getRootNode().cascadeBy(function(tree,view){var uiNode=view.getNodeByRecord(this);if(uiNode&&!Ext.Array.contains(nodesAndParents,this.id)){if(this.id!="root"){Ext.get(uiNode).setDisplayed("none")}}},null,[grid,view])}function filterByText(grid,text){this.filterBy(text,"text")}function getimghw(src){try{showTopLoading("正在加载中...");var img_url=src+"?"+Date.parse(new Date());var img=new Image();img.src=img_url;img.onload=function(){var w=img.width;var h=img.height;if(w>1000){w=800}if(h>400){h=400}if(w<100){w=260}if(h<100){h=200}Ext.create("Ext.Window",{width:w,height:h,maximizable:true,minimizable:true,listeners:{minimize:function(win,opts){if(!win.collapse()){win.collapse()}else{win.expand()}}},animateTarget:document.body,plain:true,modal:true,autoScroll:true,buttonAlign:"right",title:"图片预览",headerPosition:"left",fieldDefaults:{flex:1,margin:"5 5 5 5"},html:'<img src="'+img_url+'">'}).show();hideTopWaitMsg()};img.onerror=function(){hideTopWaitMsg();msgTishi("该图片不能预览")}}catch(e){msgTishi("该图片不能预览")}}var mergeCells=function(grid,cols){var arrayTr=document.getElementById(grid.getId()+"-body").getElementsByTagName("tr");var arrayTab=document.getElementById(grid.getId()).getElementsByTagName("table");var tab;var addfCount=0;if(arrayTab.length>0){tab=arrayTab[0];var tabBody=tab.getElementsByTagName("tbody");for(var i=0;i<arrayTr.length;i++){}}var trCount=arrayTr.length;var arrayTd;var td;var merge=function(rowspanObj,removeObjs){if(rowspanObj.rowspan!=1){addfCount=addfCount+1;arrayTd=arrayTr[rowspanObj.tr].getElementsByTagName("td");td=arrayTd[rowspanObj.td-1];td.rowSpan=rowspanObj.rowspan;td.vAlign="middle";td.style.color="rgb(255, 174, 2)";td.style.backgroundColor="antiquewhite";if(addfCount==1){td.style.backgroundColor="antiquewhite"}else{if(addfCount==2){td.style.backgroundColor="rgb(250, 215, 236)"}}Ext.each(removeObjs,function(obj){arrayTd=arrayTr[obj.tr].getElementsByTagName("td");arrayTd[col-1].innerHTML="";if(addfCount==1){arrayTd[obj.td-1].style.backgroundColor="antiquewhite"}else{if(addfCount==2){arrayTd[obj.td-1].style.backgroundColor="rgb(250, 215, 236)"}}})}};var rowspanObj={};var removeObjs=[];var col;Ext.each(cols,function(colIndex){var rowspan=1;var divHtml=null;for(var i=0;i<trCount;i++){arrayTd=arrayTr[i].getElementsByTagName("td");var cold=0;Ext.each(arrayTd,function(Td){if(Td.getAttribute("class").indexOf("x-grid-cell-special")!=-1){cold++}});col=colIndex+cold;if(!divHtml){divHtml=arrayTd[col-1].innerHTML;rowspanObj={tr:i,td:col,rowspan:rowspan}}else{var cellText=arrayTd[col-1].innerHTML;var addf=function(){rowspanObj["rowspan"]=rowspanObj["rowspan"]+1;removeObjs.push({tr:i,td:col});if(i==trCount-1){merge(rowspanObj,removeObjs)}};var mergef=function(){merge(rowspanObj,removeObjs);divHtml=cellText;rowspanObj={tr:i,td:col,rowspan:rowspan};removeObjs=[]};if(cellText==divHtml){if(colIndex!=cols[0]){var leftDisplay=arrayTd[col-2].style.display;if(leftDisplay=="none"){addf()}else{mergef()}}else{addf()}}else{mergef()}}}})};Ext.apply(Ext.form.field.VTypes,{IPAddress:function(v){return/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(v)},IPAddressText:"只能输入ip地址",IPAddressMask:/[\d\.]/i});